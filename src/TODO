# Video Layer Management & Synchronization Skill

## Core Task

Fix video layer visibility and synchronization issues where custom layers are not appearing on top or original layers are still showing when they should be removed.

---

## Problem Identification

Before making changes, identify the issue:

1. **Layer Order Issue**: Custom layer exists but original is visible
2. **Opacity Issue**: Custom layer is transparent or semi-transparent
3. **Timeline Gap**: Custom layer doesn't cover full duration
4. **Track Not Removed**: Original track still active when it should be deleted

---

## Mandatory Pre-Check Steps

**STEP 1: INVENTORY ALL VIDEO TRACKS**
- List all video tracks/layers in the project
- Note which track is original and which is custom
- Document current visibility status of each

**STEP 2: CHECK LAYER PROPERTIES**
- Verify layer order (which is on top)
- Check opacity settings for each layer
- Verify timeline duration and positioning
- Check blend modes and effects

**STEP 3: IDENTIFY ROOT CAUSE**
- Is the custom layer actually on top in the stack?
- Is the custom layer at 100% opacity?
- Does the custom layer span the full timeline?
- Is the original layer still enabled?

---

## Fix Protocols

### Protocol A: Custom Layer Should Replace Original

**Actions:**
1. Verify custom layer covers full timeline duration
2. Set custom layer opacity to 100%
3. **DELETE or DISABLE the original layer entirely**
4. Verify only custom layer remains active

**Verification:**
- Only one video track should be visible
- Timeline should show only custom layer
- Preview should show custom content only

---

### Protocol B: Custom Layer Should Overlay Original

**Actions:**
1. Move custom layer to TOP of layer stack
2. Set custom layer opacity to 100% (unless transparency is intended)
3. Ensure custom layer is enabled/visible
4. Remove any blend modes (unless specifically needed)

**Verification:**
- Layer stack shows custom above original
- Custom layer is fully opaque
- Preview shows custom layer content on top

---

### Protocol C: Timeline Synchronization

**Actions:**
1. Align custom layer start time with original (0:00 or match original start)
2. Extend custom layer duration to match or exceed original
3. Check for gaps in timeline coverage
4. Ensure no frame offset between layers

**Verification:**
- Both layers start at same timecode
- Custom layer duration >= original duration
- No timeline gaps visible

---

## Layer Stack Management Rules

**Golden Rules:**
1. **Top layer = Visible layer**: Highest layer in stack appears on top
2. **Opacity matters**: 100% = fully opaque, 0% = invisible
3. **Enabled/Disabled**: Check visibility toggles (eye icons)
4. **One source of truth**: If replacing, DELETE the original - don't just hide it

---

## Common Mistakes to Avoid

❌ **Hiding instead of deleting**: If you want to remove original, DELETE it, don't just lower opacity
❌ **Wrong layer order**: Custom layer below original in stack won't be visible
❌ **Partial timeline coverage**: Custom layer must span full duration
❌ **Blend modes active**: Check for multiply, overlay, or other blend modes
❌ **Multiple tracks enabled**: Having both original and custom visible simultaneously when only custom is wanted

---

## Verification Checklist

After making changes, verify:

- [ ] Custom layer is at top of layer stack (if overlaying)
- [ ] Custom layer opacity is 100% (unless transparency intended)
- [ ] Custom layer is enabled/visible (eye icon on)
- [ ] Original layer is deleted (if replacing) or at bottom (if overlaying)
- [ ] Timeline coverage is complete (no gaps)
- [ ] Preview shows expected result
- [ ] Playback through full timeline confirms fix
- [ ] No unwanted blend modes or effects active

---

## Debugging Steps

If issue persists after fixes:

1. **Refresh Preview**
   - Clear cache and regenerate preview
   - Some editors don't update preview in real-time

2. **Check Track Locks**
   - Verify no tracks are locked preventing changes
   - Unlock all tracks before editing

3. **Verify File Links**
   - Ensure custom layer file is properly linked
   - Check for missing media warnings

4. **Reset Effects**
   - Remove all effects temporarily to isolate issue
   - Add effects back one by one

5. **Export Test**
   - Export a short section to verify final render
   - Sometimes preview differs from actual render

---

## Summary

**Key Actions:**
1. **Identify the issue**: layer order, opacity, timeline, or deletion
2. **Fix systematically**: follow appropriate protocol
3. **Verify thoroughly**: use checklist to confirm fix
4. **Test playback**: ensure issue resolved across full timeline

**Remember**: 
- Top layer in stack = visible layer
- If replacing: DELETE original, don't hide
- If overlaying: custom must be ABOVE original
- Always verify opacity is 100% unless transparency intended
